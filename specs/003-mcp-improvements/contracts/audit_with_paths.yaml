# API Contract: Configurable Audit Paths

operation: audit_configurations
description: Audit MCP configurations across projects with customizable search directories

input:
  search_directories:
    type: array
    items: string
    required: false
    nullable: true
    description: Custom directories to scan (absolute paths)

  use_config:
    type: boolean
    required: false
    default: true
    description: Whether to load paths from config file if search_directories not provided

  detailed:
    type: boolean
    required: false
    default: false
    description: Include detailed configuration analysis

output:
  global_config:
    type: object
    properties:
      exists:
        type: boolean
      servers:
        type: integer
      status:
        type: string
        enum: ["ok", "missing", "invalid"]
    description: Status of global ~/.claude.json configuration

  project_configs:
    type: object
    additionalProperties:
      type: object
      properties:
        servers:
          type: integer
        path:
          type: string
        status:
          type: string
    description: Map of project names to their configuration status

  search_paths_used:
    type: array
    items: string
    description: Actual directories that were scanned

errors:
  InvalidPathError:
    description: One or more provided paths do not exist or are not directories

  PermissionError:
    description: Cannot read one or more directories (permission denied)

  ConfigurationError:
    description: Config file exists but cannot be parsed

examples:
  - description: "Audit with custom paths"
    input:
      search_directories: ["/home/user/work", "/mnt/projects"]
      use_config: false
      detailed: false
    output:
      global_config:
        exists: true
        servers: 6
        status: "ok"
      project_configs:
        "work/project-a":
          servers: 2
          path: "/home/user/work/project-a/.claude.json"
          status: "needs_migration"
        "projects/project-b":
          servers: 0
          path: "/mnt/projects/project-b/.claude.json"
          status: "empty"
      search_paths_used: ["/home/user/work", "/mnt/projects"]

  - description: "Audit with defaults"
    input:
      search_directories: null
      use_config: true
      detailed: false
    output:
      global_config:
        exists: true
        servers: 6
        status: "ok"
      project_configs: {}
      search_paths_used: ["/home/user/Apps", "/home/user/projects", "/home/user/repos"]

  - description: "No projects found"
    input:
      search_directories: ["/empty/directory"]
      use_config: false
      detailed: false
    output:
      global_config:
        exists: true
        servers: 6
        status: "ok"
      project_configs: {}
      search_paths_used: ["/empty/directory"]
